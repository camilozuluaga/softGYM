package desarrollo;

import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.Date;
import java.util.GregorianCalendar;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.sql.rowset.CachedRowSet;
import javax.swing.ImageIcon;
import javax.swing.JOptionPane;
import javax.swing.JTable;
import javax.swing.RowFilter;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableRowSorter;
import logica.DB;
import logica.PlaceHolder;
import logica.Utilidades;
import net.sf.jcarrierpigeon.WindowPosition;
import net.sf.jtelegraph.Telegraph;
import net.sf.jtelegraph.TelegraphQueue;
import net.sf.jtelegraph.TelegraphType;
import puerta.Puerta;

/**
 *
 * @author Dreamsoft
 */
public class VerSocio extends javax.swing.JInternalFrame {

    DefaultTableModel dtmEjemplo;
    private final DB db = new DB();
    private final AdministrarMembresia admonMembresias = new AdministrarMembresia();
    Utilidades utilidades = new Utilidades();
    public final int socioID;

    public int getSocioID() {
        return socioID;
    }
    //Variable que indica si usuario debe dinero
    private boolean usuarioDebe = false;
    int cajaActual;
    String fechaFin;
    String seleccion;
    double saldo;
    Puerta arduino;
    String nombreSocio;

    /**
     * Creates new form internalEjemplo
     *
     * @param socioID
     * @throws java.sql.SQLException
     * @throws java.text.ParseException
     */
    public VerSocio(Puerta pp, int socioID) throws SQLException, ParseException {

        initComponents();
        this.socioID = socioID;
        getSocio();
        getUltimosPagos();
        getMembresiasActivas();
        getEstadoCuenta();
        getUltimasVisitas(tablaUltimasEntradas, 5);
        getUltimasVisitas(jTable6, 60);
        getVencimientoMembresias();
        pane.setEnabledAt(1, true);
        pane.setEnabledAt(2, true);
        pane.setEnabledAt(3, true);
        pane.setEnabledAt(4, false);
        pane.setEnabledAt(5, false);
        arduino = pp;
        cargarActividadFisica();

        if (congelado().equals("no")) {
            JcongelarMembresia.setVisible(false);
        } else if (congelado().equals("congelar")) {
            JcongelarMembresia.setSelected(true);
            JcongelarMembresia.setText("Descongelar Membresia");
        }

        initRegistrarVisita();
        /*Ver Facturas cliente*/
        obtenerFacturas(socioID);

        new PlaceHolder("Filtrar Facturas ...", txtBuscar);
        if (!utilidades.socioActivo(socioID)) {
            System.out.println("skdskd");
            bEliminarMembresia.setEnabled(false);
            bAgregarMembresias.setEnabled(false);
        }

        ocultarPanel(false, false, false);

        Calendar fechaActual = new GregorianCalendar();
        dateMedidas.setCalendar(fechaActual);
    }

    public void congeladosocio() {
        try {
            if (congelado().equals("no") || congelado().equals("descongelar")) {
                JcongelarMembresia.setVisible(true);
            } else if (congelado().equals("congelar")) {
                JcongelarMembresia.setSelected(true);
                JcongelarMembresia.setText("Descongelar Membresia");
            }
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        buttonGroup1 = new javax.swing.ButtonGroup();
        pane = new javax.swing.JTabbedPane();
        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        lNombreUsuario = new javax.swing.JLabel();
        lCodigo = new javax.swing.JLabel();
        lmsjVencimiento = new javax.swing.JLabel();
        jLabel6 = new javax.swing.JLabel();
        lEstadoCuentaDescripcion = new javax.swing.JLabel();
        bRegistrarPago = new javax.swing.JButton();
        lblFoto = new javax.swing.JLabel();
        jLabel9 = new javax.swing.JLabel();
        jLabel10 = new javax.swing.JLabel();
        btnRegistrarEntrada = new javax.swing.JButton();
        bAgregarMembresias = new javax.swing.JButton();
        btnEditarSocio = new javax.swing.JButton();
        bEliminarMembresia = new javax.swing.JButton();
        lEdad = new javax.swing.JLabel();
        bRegistrarVisita = new javax.swing.JButton();
        jTabbedPane2 = new javax.swing.JTabbedPane();
        jScrollPane1 = new javax.swing.JScrollPane();
        tablaUltimosPagos = new javax.swing.JTable();
        jScrollPane2 = new javax.swing.JScrollPane();
        tablaUltimasEntradas = new javax.swing.JTable();
        jScrollPane3 = new javax.swing.JScrollPane();
        tablaMembresias = new javax.swing.JTable();
        lmsjVencimiento1 = new javax.swing.JLabel();
        lbComfenalco = new javax.swing.JLabel();
        JcongelarMembresia = new javax.swing.JCheckBox();
        jPanel14 = new javax.swing.JPanel();
        jPanel15 = new javax.swing.JPanel();
        btnAgregarMedidas = new javax.swing.JButton();
        btnConsultarMedidas = new javax.swing.JButton();
        jLabel23 = new javax.swing.JLabel();
        jLabel24 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jPanel16 = new javax.swing.JPanel();
        rbBioimpedancia = new javax.swing.JRadioButton();
        rbMedidas = new javax.swing.JRadioButton();
        panelBioimpedancia = new javax.swing.JPanel();
        txtDensidadOsea = new javax.swing.JTextField();
        jLabel34 = new javax.swing.JLabel();
        jLabel35 = new javax.swing.JLabel();
        txtMasaMuscular = new javax.swing.JTextField();
        jLabel36 = new javax.swing.JLabel();
        txtGrasa = new javax.swing.JTextField();
        panelMedidas = new javax.swing.JPanel();
        jLabel7 = new javax.swing.JLabel();
        txtPechoNormal = new javax.swing.JTextField();
        jLabel8 = new javax.swing.JLabel();
        txtPechoExtendido = new javax.swing.JTextField();
        jLabel26 = new javax.swing.JLabel();
        txtCinturaNormal = new javax.swing.JTextField();
        jLabel27 = new javax.swing.JLabel();
        txtCinturaSumida = new javax.swing.JTextField();
        jLabel28 = new javax.swing.JLabel();
        txtBrazoDerecho = new javax.swing.JTextField();
        jLabel29 = new javax.swing.JLabel();
        txtBrazoIzquierdo = new javax.swing.JTextField();
        jLabel30 = new javax.swing.JLabel();
        txtPiernaDerecha = new javax.swing.JTextField();
        jLabel31 = new javax.swing.JLabel();
        txtPiernaIzquierda = new javax.swing.JTextField();
        jLabel32 = new javax.swing.JLabel();
        txtPantorrillaDerecha = new javax.swing.JTextField();
        jLabel33 = new javax.swing.JLabel();
        txtPantorrillaIzquierda = new javax.swing.JTextField();
        jLabel37 = new javax.swing.JLabel();
        txtCuello = new javax.swing.JTextField();
        panelBasico = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        dateMedidas = new com.toedter.calendar.JDateChooser();
        jLabel2 = new javax.swing.JLabel();
        lblSexoMedidas = new javax.swing.JLabel();
        jLabel3 = new javax.swing.JLabel();
        cboTipoActividad = new javax.swing.JComboBox<>();
        jLabel4 = new javax.swing.JLabel();
        txtPesoMedidas = new javax.swing.JTextField();
        jLabel5 = new javax.swing.JLabel();
        txtAlturaMedidas = new javax.swing.JTextField();
        jPanel7 = new javax.swing.JPanel();
        jPanel8 = new javax.swing.JPanel();
        jScrollPane6 = new javax.swing.JScrollPane();
        jTable6 = new javax.swing.JTable();
        jPanel11 = new javax.swing.JPanel();
        jLabel17 = new javax.swing.JLabel();
        jLabel18 = new javax.swing.JLabel();
        jLabel19 = new javax.swing.JLabel();
        jPanel12 = new javax.swing.JPanel();
        jPanel13 = new javax.swing.JPanel();
        jLabel20 = new javax.swing.JLabel();
        jLabel21 = new javax.swing.JLabel();
        jLabel22 = new javax.swing.JLabel();
        jScrollPane7 = new javax.swing.JScrollPane();
        jtFactura = new javax.swing.JTable();
        txtBuscar = new javax.swing.JTextField();
        jPanel3 = new javax.swing.JPanel();
        jPanel4 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jButton2 = new javax.swing.JButton();
        jButton4 = new javax.swing.JButton();
        jButton3 = new javax.swing.JButton();
        jLabel11 = new javax.swing.JLabel();
        jLabel12 = new javax.swing.JLabel();
        jLabel13 = new javax.swing.JLabel();
        jScrollPane4 = new javax.swing.JScrollPane();
        jTable4 = new javax.swing.JTable();
        jPanel6 = new javax.swing.JPanel();
        jPanel9 = new javax.swing.JPanel();
        jPanel10 = new javax.swing.JPanel();
        jButton5 = new javax.swing.JButton();
        jButton6 = new javax.swing.JButton();
        jButton7 = new javax.swing.JButton();
        jLabel14 = new javax.swing.JLabel();
        jLabel15 = new javax.swing.JLabel();
        jLabel16 = new javax.swing.JLabel();
        jScrollPane5 = new javax.swing.JScrollPane();
        jTable5 = new javax.swing.JTable();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Ver Socio");

        jPanel2.setBackground(new java.awt.Color(255, 255, 255));

        lNombreUsuario.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        lNombreUsuario.setText("Pepito Perez Pingüino");

        lCodigo.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        lCodigo.setText("Codigo: 0000");

        lmsjVencimiento.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        lmsjVencimiento.setText("Membresía Vence en:");

        jLabel6.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jLabel6.setText("Estado de la cuenta: ");

        lEstadoCuentaDescripcion.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        lEstadoCuentaDescripcion.setForeground(new java.awt.Color(255, 0, 0));
        lEstadoCuentaDescripcion.setText("Debe  32.000 Pesos");

        bRegistrarPago.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/moneda.png"))); // NOI18N
        bRegistrarPago.setText("Pagar");
        bRegistrarPago.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bRegistrarPagoActionPerformed(evt);
            }
        });

        lblFoto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/sin_foto.png"))); // NOI18N
        lblFoto.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        jLabel9.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel9.setText("Ultimas Entradas");

        jLabel10.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jLabel10.setText("Membresías");

        btnRegistrarEntrada.setBackground(new java.awt.Color(0, 102, 0));
        btnRegistrarEntrada.setForeground(new java.awt.Color(255, 255, 255));
        btnRegistrarEntrada.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar pequeno.png"))); // NOI18N
        btnRegistrarEntrada.setText("Registrar Entrada");
        btnRegistrarEntrada.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnRegistrarEntradaActionPerformed(evt);
            }
        });

        bAgregarMembresias.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar pequeno.png"))); // NOI18N
        bAgregarMembresias.setText("Agregar");
        bAgregarMembresias.setPreferredSize(new java.awt.Dimension(141, 29));
        bAgregarMembresias.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bAgregarMembresiasActionPerformed(evt);
            }
        });

        btnEditarSocio.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/editar.png"))); // NOI18N
        btnEditarSocio.setText("Editar Socio");
        btnEditarSocio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarSocioActionPerformed(evt);
            }
        });

        bEliminarMembresia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/dialog_error.png"))); // NOI18N
        bEliminarMembresia.setText("Quitar membresía");
        bEliminarMembresia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bEliminarMembresiaActionPerformed(evt);
            }
        });

        lEdad.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        lEdad.setText("20 años");

        bRegistrarVisita.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar pequeno.png"))); // NOI18N
        bRegistrarVisita.setText("Registrar Visita");
        bRegistrarVisita.setMaximumSize(new java.awt.Dimension(184, 30));
        bRegistrarVisita.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bRegistrarVisitaActionPerformed(evt);
            }
        });

        jTabbedPane2.setBorder(javax.swing.BorderFactory.createTitledBorder(""));

        tablaUltimosPagos.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tablaUltimosPagos.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tablaUltimosPagosMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tablaUltimosPagos);

        jTabbedPane2.addTab("Ultimos Pagos", jScrollPane1);

        tablaUltimasEntradas.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tablaUltimasEntradas.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tablaUltimasEntradasMouseClicked(evt);
            }
        });
        jScrollPane2.setViewportView(tablaUltimasEntradas);

        jTabbedPane2.addTab("Ultimas Entradas", jScrollPane2);

        tablaMembresias.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        tablaMembresias.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tablaMembresiasMouseClicked(evt);
            }
        });
        jScrollPane3.setViewportView(tablaMembresias);

        jTabbedPane2.addTab("Membresías", jScrollPane3);

        lmsjVencimiento1.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        lmsjVencimiento1.setText("Comfenalco:");

        lbComfenalco.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        lbComfenalco.setForeground(new java.awt.Color(255, 0, 0));
        lbComfenalco.setText("NO");

        JcongelarMembresia.setText("Congelar Membresia");
        JcongelarMembresia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                JcongelarMembresiaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(lblFoto, javax.swing.GroupLayout.PREFERRED_SIZE, 135, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addComponent(lmsjVencimiento1)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(lbComfenalco, javax.swing.GroupLayout.PREFERRED_SIZE, 220, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addComponent(jLabel6)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                        .addComponent(lEstadoCuentaDescripcion, javax.swing.GroupLayout.PREFERRED_SIZE, 227, javax.swing.GroupLayout.PREFERRED_SIZE))
                                    .addGroup(jPanel2Layout.createSequentialGroup()
                                        .addComponent(lCodigo)
                                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                        .addComponent(lEdad))
                                    .addComponent(lmsjVencimiento))
                                .addGap(0, 0, Short.MAX_VALUE))
                            .addComponent(lNombreUsuario, javax.swing.GroupLayout.DEFAULT_SIZE, 476, Short.MAX_VALUE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(btnEditarSocio, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(bRegistrarPago, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(JcongelarMembresia, javax.swing.GroupLayout.DEFAULT_SIZE, 159, Short.MAX_VALUE)))
                    .addComponent(jTabbedPane2)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addComponent(bRegistrarVisita, javax.swing.GroupLayout.PREFERRED_SIZE, 169, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(btnRegistrarEntrada, javax.swing.GroupLayout.PREFERRED_SIZE, 161, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(63, 63, 63)
                        .addComponent(bEliminarMembresia)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(bAgregarMembresias, javax.swing.GroupLayout.PREFERRED_SIZE, 162, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(108, 108, 108)
                        .addComponent(jLabel9, javax.swing.GroupLayout.PREFERRED_SIZE, 148, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jLabel10)
                        .addGap(130, 130, 130)))
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(16, 16, 16)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                            .addGroup(jPanel2Layout.createSequentialGroup()
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(lNombreUsuario)
                                    .addComponent(btnEditarSocio, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                    .addComponent(lCodigo)
                                    .addComponent(lEdad))
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(lmsjVencimiento))
                            .addComponent(bRegistrarPago, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel6, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lEstadoCuentaDescripcion)
                            .addComponent(JcongelarMembresia))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lmsjVencimiento1)
                            .addComponent(lbComfenalco))
                        .addGap(19, 19, 19))
                    .addGroup(jPanel2Layout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addComponent(lblFoto, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(18, 18, 18)))
                .addComponent(jTabbedPane2, javax.swing.GroupLayout.DEFAULT_SIZE, 296, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel9)
                    .addComponent(jLabel10, javax.swing.GroupLayout.PREFERRED_SIZE, 23, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(6, 6, 6)
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(bRegistrarVisita, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btnRegistrarEntrada, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bEliminarMembresia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(bAgregarMembresias, javax.swing.GroupLayout.PREFERRED_SIZE, 43, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(23, 23, 23))
        );

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(0, 0, 0))
        );

        pane.addTab("Información Básica", jPanel1);

        jPanel15.setBackground(new java.awt.Color(255, 255, 255));

        btnAgregarMedidas.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar.png"))); // NOI18N
        btnAgregarMedidas.setText("Guardar");
        btnAgregarMedidas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAgregarMedidasActionPerformed(evt);
            }
        });

        btnConsultarMedidas.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/buscar.png"))); // NOI18N
        btnConsultarMedidas.setText("Consultar");
        btnConsultarMedidas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnConsultarMedidasActionPerformed(evt);
            }
        });

        jLabel23.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel23.setText("Toma de Medidas");

        jLabel24.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel24.setText("Podras realizar la toma de medidas del socio y llevar un control del mismo.");

        jLabel25.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/hoja.png"))); // NOI18N

        javax.swing.GroupLayout jPanel15Layout = new javax.swing.GroupLayout(jPanel15);
        jPanel15.setLayout(jPanel15Layout);
        jPanel15Layout.setHorizontalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel15Layout.createSequentialGroup()
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel25)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel23))
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addGap(20, 20, 20)
                        .addComponent(jLabel24, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnAgregarMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(btnConsultarMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 131, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(27, 27, 27))
        );
        jPanel15Layout.setVerticalGroup(
            jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel15Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(btnAgregarMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(btnConsultarMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel15Layout.createSequentialGroup()
                        .addGroup(jPanel15Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel25)
                            .addComponent(jLabel23))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel24)))
                .addGap(61, 61, 61))
        );

        jPanel16.setBorder(javax.swing.BorderFactory.createTitledBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 2, true), "Tipo de Medida"));

        buttonGroup1.add(rbBioimpedancia);
        rbBioimpedancia.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        rbBioimpedancia.setText("Bio Impedancia");
        rbBioimpedancia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rbBioimpedanciaActionPerformed(evt);
            }
        });

        buttonGroup1.add(rbMedidas);
        rbMedidas.setFont(new java.awt.Font("Arial", 1, 14)); // NOI18N
        rbMedidas.setText("Medidas Antropometricas");
        rbMedidas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rbMedidasActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel16Layout = new javax.swing.GroupLayout(jPanel16);
        jPanel16.setLayout(jPanel16Layout);
        jPanel16Layout.setHorizontalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addGap(53, 53, 53)
                .addComponent(rbBioimpedancia, javax.swing.GroupLayout.PREFERRED_SIZE, 154, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(rbMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 220, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(61, 61, 61))
        );
        jPanel16Layout.setVerticalGroup(
            jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel16Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel16Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(rbBioimpedancia)
                    .addComponent(rbMedidas))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        panelBioimpedancia.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 2, true));

        txtDensidadOsea.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtDensidadOsea.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtDensidadOseaKeyReleased(evt);
            }
        });

        jLabel34.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel34.setText("Densidad Osea");

        jLabel35.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel35.setText("% de Masa Muscular");

        txtMasaMuscular.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtMasaMuscular.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtMasaMuscularKeyReleased(evt);
            }
        });

        jLabel36.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel36.setText("% de Grasa");

        txtGrasa.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtGrasa.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtGrasaKeyReleased(evt);
            }
        });

        javax.swing.GroupLayout panelBioimpedanciaLayout = new javax.swing.GroupLayout(panelBioimpedancia);
        panelBioimpedancia.setLayout(panelBioimpedanciaLayout);
        panelBioimpedanciaLayout.setHorizontalGroup(
            panelBioimpedanciaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelBioimpedanciaLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jLabel34, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtDensidadOsea, javax.swing.GroupLayout.PREFERRED_SIZE, 77, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(70, 70, 70)
                .addComponent(jLabel35, javax.swing.GroupLayout.PREFERRED_SIZE, 141, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(txtMasaMuscular, javax.swing.GroupLayout.PREFERRED_SIZE, 63, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(jLabel36)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(txtGrasa, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(61, 61, 61))
        );
        panelBioimpedanciaLayout.setVerticalGroup(
            panelBioimpedanciaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelBioimpedanciaLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelBioimpedanciaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(txtMasaMuscular, javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, panelBioimpedanciaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel34)
                        .addComponent(txtDensidadOsea, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel36)
                        .addComponent(txtGrasa, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel35)))
                .addContainerGap(23, Short.MAX_VALUE))
        );

        panelMedidas.setBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 2, true));

        jLabel7.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel7.setText("Pecho Normal");

        txtPechoNormal.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPechoNormal.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPechoNormalKeyReleased(evt);
            }
        });

        jLabel8.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel8.setText("Pecho Expandido");

        txtPechoExtendido.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPechoExtendido.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPechoExtendidoKeyReleased(evt);
            }
        });

        jLabel26.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel26.setText("Cintura Normal");

        txtCinturaNormal.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtCinturaNormal.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtCinturaNormalKeyReleased(evt);
            }
        });

        jLabel27.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel27.setText("Cintura Sumida");

        txtCinturaSumida.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtCinturaSumida.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtCinturaSumidaKeyReleased(evt);
            }
        });

        jLabel28.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel28.setText("Brazo Derecho");

        txtBrazoDerecho.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtBrazoDerecho.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtBrazoDerechoKeyReleased(evt);
            }
        });

        jLabel29.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel29.setText("Brazo Izquierdo");

        txtBrazoIzquierdo.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtBrazoIzquierdo.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtBrazoIzquierdoKeyReleased(evt);
            }
        });

        jLabel30.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel30.setText("Pierna Derecha");

        txtPiernaDerecha.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPiernaDerecha.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPiernaDerechaKeyReleased(evt);
            }
        });

        jLabel31.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel31.setText("Pierna Izquierda");

        txtPiernaIzquierda.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPiernaIzquierda.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPiernaIzquierdaKeyReleased(evt);
            }
        });

        jLabel32.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel32.setText("Pantorrilla Derecha");

        txtPantorrillaDerecha.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPantorrillaDerecha.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPantorrillaDerechaKeyReleased(evt);
            }
        });

        jLabel33.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel33.setText("Pantorilla Izquierda");

        txtPantorrillaIzquierda.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPantorrillaIzquierda.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPantorrillaIzquierdaKeyReleased(evt);
            }
        });

        jLabel37.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        jLabel37.setText("Cuello");

        txtCuello.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtCuello.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtCuelloKeyReleased(evt);
            }
        });

        javax.swing.GroupLayout panelMedidasLayout = new javax.swing.GroupLayout(panelMedidas);
        panelMedidas.setLayout(panelMedidasLayout);
        panelMedidasLayout.setHorizontalGroup(
            panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelMedidasLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(panelMedidasLayout.createSequentialGroup()
                        .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addComponent(jLabel7, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jLabel26, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(jLabel37))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtCuello, javax.swing.GroupLayout.PREFERRED_SIZE, 59, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtCinturaNormal, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtPechoNormal, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(18, 18, 18)
                        .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jLabel8)
                            .addComponent(jLabel27, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(panelMedidasLayout.createSequentialGroup()
                        .addComponent(jLabel30, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtPiernaDerecha, javax.swing.GroupLayout.PREFERRED_SIZE, 61, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel31, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPiernaIzquierda)
                    .addComponent(txtPechoExtendido)
                    .addComponent(txtCinturaSumida))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelMedidasLayout.createSequentialGroup()
                        .addComponent(jLabel28, javax.swing.GroupLayout.PREFERRED_SIZE, 93, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(txtBrazoDerecho, javax.swing.GroupLayout.PREFERRED_SIZE, 66, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jLabel29, javax.swing.GroupLayout.PREFERRED_SIZE, 96, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(panelMedidasLayout.createSequentialGroup()
                        .addComponent(jLabel32, javax.swing.GroupLayout.PREFERRED_SIZE, 106, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtPantorrillaDerecha, javax.swing.GroupLayout.PREFERRED_SIZE, 67, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel33, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPantorrillaIzquierda, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtBrazoIzquierdo, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(16, 16, 16))
        );
        panelMedidasLayout.setVerticalGroup(
            panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelMedidasLayout.createSequentialGroup()
                .addGap(19, 19, 19)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jLabel37)
                    .addComponent(txtCuello, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPechoNormal)
                    .addComponent(txtBrazoDerecho)
                    .addComponent(txtBrazoIzquierdo)
                    .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel7)
                        .addComponent(jLabel8)
                        .addComponent(txtPechoExtendido, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel29)
                        .addComponent(jLabel28)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPantorrillaDerecha, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jLabel26)
                        .addComponent(txtCinturaNormal, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel27)
                        .addComponent(jLabel32)
                        .addComponent(jLabel33)
                        .addComponent(txtPantorrillaIzquierda, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(txtCinturaSumida, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtPiernaDerecha, javax.swing.GroupLayout.Alignment.TRAILING)
                    .addGroup(panelMedidasLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txtPiernaIzquierda, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jLabel31)
                        .addComponent(jLabel30)))
                .addGap(91, 91, 91))
        );

        panelBasico.setBorder(javax.swing.BorderFactory.createTitledBorder(new javax.swing.border.LineBorder(new java.awt.Color(0, 0, 0), 2, true), "Datos Básicos"));

        jLabel1.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel1.setText("Fecha registro");

        jLabel2.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel2.setText("Sexo");

        lblSexoMedidas.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N

        jLabel3.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel3.setText("Tipo Actividad Fisica");

        cboTipoActividad.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N

        jLabel4.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel4.setText("Peso (kg)");

        txtPesoMedidas.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtPesoMedidas.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtPesoMedidasKeyReleased(evt);
            }
        });

        jLabel5.setFont(new java.awt.Font("Arial", 0, 14)); // NOI18N
        jLabel5.setText("Estatura (mts)");

        txtAlturaMedidas.setFont(new java.awt.Font("Arial", 0, 12)); // NOI18N
        txtAlturaMedidas.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtAlturaMedidasKeyReleased(evt);
            }
        });

        javax.swing.GroupLayout panelBasicoLayout = new javax.swing.GroupLayout(panelBasico);
        panelBasico.setLayout(panelBasicoLayout);
        panelBasicoLayout.setHorizontalGroup(
            panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelBasicoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel1)
                    .addComponent(jLabel4))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(dateMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 123, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txtPesoMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(47, 47, 47)
                .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelBasicoLayout.createSequentialGroup()
                        .addComponent(jLabel2)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(lblSexoMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(69, 69, 69)
                        .addComponent(jLabel3)
                        .addGap(18, 18, 18)
                        .addComponent(cboTipoActividad, javax.swing.GroupLayout.PREFERRED_SIZE, 118, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(panelBasicoLayout.createSequentialGroup()
                        .addComponent(jLabel5)
                        .addGap(18, 18, 18)
                        .addComponent(txtAlturaMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        panelBasicoLayout.setVerticalGroup(
            panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelBasicoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(panelBasicoLayout.createSequentialGroup()
                        .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lblSexoMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 20, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jLabel2))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jLabel5)
                            .addComponent(txtAlturaMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(panelBasicoLayout.createSequentialGroup()
                        .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jLabel1)
                                .addComponent(jLabel3)
                                .addComponent(cboTipoActividad, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addComponent(dateMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGroup(panelBasicoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(panelBasicoLayout.createSequentialGroup()
                                .addGap(9, 9, 9)
                                .addComponent(jLabel4))
                            .addGroup(panelBasicoLayout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                .addComponent(txtPesoMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))))
                .addContainerGap(12, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel14Layout = new javax.swing.GroupLayout(jPanel14);
        jPanel14.setLayout(jPanel14Layout);
        jPanel14Layout.setHorizontalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel16, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(panelBasico, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel14Layout.createSequentialGroup()
                        .addComponent(panelMedidas, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGap(4, 4, 4))
                    .addComponent(panelBioimpedancia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
            .addComponent(jPanel15, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel14Layout.setVerticalGroup(
            jPanel14Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel14Layout.createSequentialGroup()
                .addComponent(jPanel15, javax.swing.GroupLayout.PREFERRED_SIZE, 83, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jPanel16, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(panelBasico, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(panelBioimpedancia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(panelMedidas, javax.swing.GroupLayout.PREFERRED_SIZE, 198, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(27, Short.MAX_VALUE))
        );

        pane.addTab("Medidas", jPanel14);

        javax.swing.GroupLayout jPanel8Layout = new javax.swing.GroupLayout(jPanel8);
        jPanel8.setLayout(jPanel8Layout);
        jPanel8Layout.setHorizontalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );
        jPanel8Layout.setVerticalGroup(
            jPanel8Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 0, Short.MAX_VALUE)
        );

        jTable6.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jTable6.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jTable6MouseClicked(evt);
            }
        });
        jScrollPane6.setViewportView(jTable6);

        jPanel11.setBackground(new java.awt.Color(255, 255, 255));

        jLabel17.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel17.setText("Entradas");

        jLabel18.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel18.setText("Registro de entradas del cliente.");

        jLabel19.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/Person-add-black-32.png"))); // NOI18N

        javax.swing.GroupLayout jPanel11Layout = new javax.swing.GroupLayout(jPanel11);
        jPanel11.setLayout(jPanel11Layout);
        jPanel11Layout.setHorizontalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel11Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addComponent(jLabel19)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel17, javax.swing.GroupLayout.PREFERRED_SIZE, 140, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel11Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel18, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(580, Short.MAX_VALUE))
        );
        jPanel11Layout.setVerticalGroup(
            jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel11Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel11Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel19)
                    .addComponent(jLabel17))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel18)
                .addGap(61, 61, 61))
        );

        javax.swing.GroupLayout jPanel7Layout = new javax.swing.GroupLayout(jPanel7);
        jPanel7.setLayout(jPanel7Layout);
        jPanel7Layout.setHorizontalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel11, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addGap(579, 579, 579)
                .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
            .addComponent(jScrollPane6, javax.swing.GroupLayout.Alignment.TRAILING)
        );
        jPanel7Layout.setVerticalGroup(
            jPanel7Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel7Layout.createSequentialGroup()
                .addComponent(jPanel11, javax.swing.GroupLayout.PREFERRED_SIZE, 99, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane6, javax.swing.GroupLayout.PREFERRED_SIZE, 480, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel8, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGap(352, 352, 352))
        );

        pane.addTab("Entradas", jPanel7);

        jPanel13.setBackground(new java.awt.Color(255, 255, 255));

        jLabel20.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel20.setText("Historico Facturas");

        jLabel21.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel21.setText("Facturas Impresas por Socio");

        jLabel22.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/hoja.png"))); // NOI18N

        javax.swing.GroupLayout jPanel13Layout = new javax.swing.GroupLayout(jPanel13);
        jPanel13.setLayout(jPanel13Layout);
        jPanel13Layout.setHorizontalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel13Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addComponent(jLabel22)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel20))
                    .addGroup(jPanel13Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel21, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(472, Short.MAX_VALUE))
        );
        jPanel13Layout.setVerticalGroup(
            jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel13Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel13Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel22)
                    .addComponent(jLabel20))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel21)
                .addGap(61, 61, 61))
        );

        jtFactura.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "COD FACTURA", "FECHA FACTURA", "DETALLE FACTURA", "VALOR"
            }
        ));
        jtFactura.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                jtFacturaMouseClicked(evt);
            }
        });
        jScrollPane7.setViewportView(jtFactura);

        txtBuscar.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        txtBuscar.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                txtBuscarFocusLost(evt);
            }
        });
        txtBuscar.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                txtBuscarKeyReleased(evt);
            }
        });

        javax.swing.GroupLayout jPanel12Layout = new javax.swing.GroupLayout(jPanel12);
        jPanel12.setLayout(jPanel12Layout);
        jPanel12Layout.setHorizontalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jScrollPane7)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel12Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(txtBuscar, javax.swing.GroupLayout.PREFERRED_SIZE, 343, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(193, 193, 193))
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );
        jPanel12Layout.setVerticalGroup(
            jPanel12Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel12Layout.createSequentialGroup()
                .addComponent(jPanel13, javax.swing.GroupLayout.PREFERRED_SIZE, 94, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(txtBuscar, javax.swing.GroupLayout.DEFAULT_SIZE, 44, Short.MAX_VALUE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jScrollPane7, javax.swing.GroupLayout.PREFERRED_SIZE, 412, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(21, 21, 21))
        );

        pane.addTab("Facturas", jPanel12);

        jPanel5.setBackground(new java.awt.Color(255, 255, 255));

        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar.png"))); // NOI18N
        jButton2.setText("Agregar");

        jButton4.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/caneco.png"))); // NOI18N
        jButton4.setText("Eliminar");
        jButton4.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton4ActionPerformed(evt);
            }
        });

        jButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/editar.png"))); // NOI18N
        jButton3.setText("Editar");

        jLabel11.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel11.setText("Membresías");

        jLabel12.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel12.setText("Planes o membresías del socio.");

        jLabel13.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/hoja.png"))); // NOI18N

        javax.swing.GroupLayout jPanel5Layout = new javax.swing.GroupLayout(jPanel5);
        jPanel5.setLayout(jPanel5Layout);
        jPanel5Layout.setHorizontalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel5Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addComponent(jLabel13)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel11))
                    .addGroup(jPanel5Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel12, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 205, Short.MAX_VALUE)
                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton4, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12))
        );
        jPanel5Layout.setVerticalGroup(
            jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel5Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel13)
                    .addComponent(jLabel11))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jButton2, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jButton3, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jButton4))
                    .addComponent(jLabel12))
                .addGap(36, 36, 36))
        );

        jTable4.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane4.setViewportView(jTable4);

        javax.swing.GroupLayout jPanel4Layout = new javax.swing.GroupLayout(jPanel4);
        jPanel4.setLayout(jPanel4Layout);
        jPanel4Layout.setHorizontalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel5, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addComponent(jScrollPane4)
                .addContainerGap())
        );
        jPanel4Layout.setVerticalGroup(
            jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel4Layout.createSequentialGroup()
                .addComponent(jPanel5, javax.swing.GroupLayout.PREFERRED_SIZE, 97, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane4, javax.swing.GroupLayout.DEFAULT_SIZE, 246, Short.MAX_VALUE)
                .addGap(4, 4, 4))
        );

        javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
        jPanel3.setLayout(jPanel3Layout);
        jPanel3Layout.setHorizontalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel3Layout.setVerticalGroup(
            jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel3Layout.createSequentialGroup()
                .addComponent(jPanel4, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        pane.addTab("Membresías", jPanel3);

        jPanel10.setBackground(new java.awt.Color(255, 255, 255));

        jButton5.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/agregar.png"))); // NOI18N
        jButton5.setText("Agregar");

        jButton6.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/caneco.png"))); // NOI18N
        jButton6.setText("Eliminar");
        jButton6.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton6ActionPerformed(evt);
            }
        });

        jButton7.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/editar.png"))); // NOI18N
        jButton7.setText("Editar");

        jLabel14.setFont(new java.awt.Font("Tahoma", 1, 24)); // NOI18N
        jLabel14.setText("Pagos");

        jLabel15.setFont(new java.awt.Font("Tahoma", 2, 14)); // NOI18N
        jLabel15.setText("Pagos realizados por el socio.");

        jLabel16.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagen/moneda.png"))); // NOI18N

        javax.swing.GroupLayout jPanel10Layout = new javax.swing.GroupLayout(jPanel10);
        jPanel10.setLayout(jPanel10Layout);
        jPanel10Layout.setHorizontalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel10Layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addComponent(jLabel16)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jLabel14))
                    .addGroup(jPanel10Layout.createSequentialGroup()
                        .addGap(10, 10, 10)
                        .addComponent(jLabel15, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 205, Short.MAX_VALUE)
                        .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, 113, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jButton6, javax.swing.GroupLayout.PREFERRED_SIZE, 117, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(12, 12, 12))
        );
        jPanel10Layout.setVerticalGroup(
            jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel10Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jLabel16)
                    .addComponent(jLabel14))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel10Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jButton5, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jButton7, javax.swing.GroupLayout.PREFERRED_SIZE, 42, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(jButton6))
                    .addComponent(jLabel15))
                .addGap(36, 36, 36))
        );

        jTable5.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "Title 1", "Title 2", "Title 3", "Title 4"
            }
        ));
        jScrollPane5.setViewportView(jTable5);

        javax.swing.GroupLayout jPanel9Layout = new javax.swing.GroupLayout(jPanel9);
        jPanel9.setLayout(jPanel9Layout);
        jPanel9Layout.setHorizontalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel10, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane5))
        );
        jPanel9Layout.setVerticalGroup(
            jPanel9Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel9Layout.createSequentialGroup()
                .addComponent(jPanel10, javax.swing.GroupLayout.PREFERRED_SIZE, 97, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(jScrollPane5, javax.swing.GroupLayout.PREFERRED_SIZE, 292, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 186, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel9, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pane.addTab("Pagos", jPanel6);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(pane)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(pane, javax.swing.GroupLayout.PREFERRED_SIZE, 621, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jButton6ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton6ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton6ActionPerformed

    private void jButton4ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton4ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_jButton4ActionPerformed

    private void txtBuscarKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtBuscarKeyReleased
        // TODO add your handling code here:
        if (txtBuscar.getText().length() >= 0) {
            TableRowSorter sorter = new TableRowSorter(dtmEjemplo);
            sorter.setRowFilter(RowFilter.regexFilter(".*" + txtBuscar.getText().trim() + ".*"));
            jtFactura.setRowSorter(sorter);
        }
    }//GEN-LAST:event_txtBuscarKeyReleased

    private void txtBuscarFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_txtBuscarFocusLost

    }//GEN-LAST:event_txtBuscarFocusLost

    private void jtFacturaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jtFacturaMouseClicked
        if (evt.getClickCount() == 1) {
            int row = jtFactura.rowAtPoint(evt.getPoint());
            int id = Integer.valueOf(jtFactura.getValueAt(row, 0).toString());
            ImprimirRecibo imprimirRecibo = new ImprimirRecibo(id);
            Frame.escritorio.add(imprimirRecibo);
            imprimirRecibo.toFront();
            imprimirRecibo.setVisible(true);
            Utilidades.centrarInternalFrame(imprimirRecibo);
        }
    }//GEN-LAST:event_jtFacturaMouseClicked

    private void jTable6MouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable6MouseClicked
        if (evt.getClickCount() == 1) {
            int row = tablaUltimasEntradas.rowAtPoint(evt.getPoint());
            utilidades.construirFormulario(tablaUltimasEntradas, row, "Detalle Ultimas Entradas");
        }
    }//GEN-LAST:event_jTable6MouseClicked

    private void JcongelarMembresiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_JcongelarMembresiaActionPerformed
        if (JcongelarMembresia.isSelected()) {

            CongelarMembresia congelarMembresia = new CongelarMembresia(socioID, this, JcongelarMembresia);
            congelarMembresia.setVisible(true);

        } else {
            try {
                modificarFechaFinMembresia(restarDias(diasRestantesCongelados(), obtenerFechaFinMembresias()), obtenerIdMembresias());
                editarFechaCongelado(restarDiasFecha(diasRestantesCongelados(), obtenerFechaCongelacion()), socioID);
            } catch (ParseException ex) {
                Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
            } catch (SQLException ex) {
                Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
            }
            JcongelarMembresia.setText("Congelar Membresia");
            editarCongelado("descongelar", socioID);
            updateDatos();
        }
    }//GEN-LAST:event_JcongelarMembresiaActionPerformed

    private void tablaMembresiasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tablaMembresiasMouseClicked
        if (evt.getClickCount() == 1) {
            int row = tablaMembresias.rowAtPoint(evt.getPoint());
            utilidades.construirFormulario(tablaMembresias, row, "Detalle Membresias Adquiridas");
        }
    }//GEN-LAST:event_tablaMembresiasMouseClicked

    private void tablaUltimasEntradasMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tablaUltimasEntradasMouseClicked
        if (evt.getClickCount() == 1) {
            int row = tablaUltimasEntradas.rowAtPoint(evt.getPoint());
            utilidades.construirFormulario(tablaUltimasEntradas, row, "Detalle Ultimas Entradas");
        }
    }//GEN-LAST:event_tablaUltimasEntradasMouseClicked

    private void tablaUltimosPagosMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tablaUltimosPagosMouseClicked
        if (evt.getClickCount() == 1) {
            int row = tablaUltimosPagos.rowAtPoint(evt.getPoint());
            utilidades.construirFormulario(tablaUltimosPagos, row, "Detalle Pago");
        }
    }//GEN-LAST:event_tablaUltimosPagosMouseClicked

    private void bRegistrarVisitaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bRegistrarVisitaActionPerformed
        try {
            RegistrarVisita rg = new RegistrarVisita(arduino, getDatosSocio()[0], getDatosSocio()[1], getDatosSocio()[2], getDatosSocio()[3], getDatosSocio()[4], getDatosSocio()[5]);
            Frame.escritorio.add(rg);
            rg.toFront();
            Utilidades.centrarInternalFrame(rg);
            rg.setVisible(true);
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_bRegistrarVisitaActionPerformed

    private void bEliminarMembresiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bEliminarMembresiaActionPerformed
            

        
        if (tablaMembresias.getSelectedRow() >= 0) {

            try {
                seleccion = admonMembresias.obtenerIdMembresia(tablaMembresias);
                System.out.println("seleccion = " + seleccion);
                fechaFin = obtenerFechaFinMembresia(tablaMembresias);
                System.out.println("fechaFin = " + fechaFin);

                // Id de la adquisicion usuario-membresia
                int membresia_id = traerIdMembresiaAdquirida(fechaFin);
                System.out.println("membresia_id = " + membresia_id);

                // verificar que la membresía seleccionada está activa.
                String consultaMembresiaSeleccionadaEstaActiva = String.format("SELECT activa from membresia_usuario where id=%s;", membresia_id);
                System.out.println("activa: SELECT activa from membresia_usuario where id=" + membresia_id);
                ResultSet rs2 = db.sqlDatos(consultaMembresiaSeleccionadaEstaActiva);
                boolean activa = false;
                if (rs2.next()) {
                    activa = rs2.getBoolean(1);
                }
                if (!activa) {
                    Telegraph tele = new Telegraph("Eliminar Membresia", "Esta membresía no puede ser eliminada. Ya fue utilizada.", TelegraphType.NOTIFICATION_ERROR, WindowPosition.TOPRIGHT, 5000);
                    TelegraphQueue q = new TelegraphQueue();
                    q.add(tele);

                } else if (!ValidarPago()) {
                    int cajaDelPago = 0;
                    CachedRowSet data;
                    String query = "SELECT id_caja  FROM pago_membresia WHERE pago>0 AND membresiadatos_id=" + membresia_id;
                    data = db.sqlDatos(query);
                    try {
                        while (data.next()) {
                            cajaDelPago = data.getInt("id_caja");
                        }
                    } catch (SQLException ex) {
                        Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    cajaActual = utilidades.cajaActual();
                    System.out.println("caja del pago " + cajaDelPago);
                    System.out.println("caja actual " + cajaActual);
                    if (cajaDelPago == cajaActual) {
                        String consultaMembresiaPago_id = String.format("SELECT id as identificador FROM membresia_datos WHERE membresia_socio_id=%s", membresia_id);
                        ResultSet rs3 = db.sqlDatos(consultaMembresiaPago_id);
                        int identificador = 0;
                        if (rs3.next()) {
                            identificador = rs3.getInt("identificador");
                            System.out.println("identificador = " + identificador);
                        }
                        String consultaCuandoHaPagado = String.format("SELECT saldo FROM pago_membresia where membresiadatos_id =%s ORDER BY fecha_registro DESC limit 1;", identificador);
                        ResultSet rs4 = db.sqlDatos(consultaCuandoHaPagado);
                        double saldoMembresia = 0.0;
                        if (rs4.next()) {
                            // esta consulta permite saber cuanto se ha pagado por una membresía.
                            saldoMembresia = rs4.getDouble("saldo");
                            System.out.println("saldoMembresia = " + saldoMembresia);
                        }

                        if (saldoMembresia == 0.0) {
                            System.out.println("El usuario ya pagó esta membresía o es gratuita.");

                            String cosultaValorMembresia = String.format("SELECT saldo as consulta FROM pago_membresia WHERE socio_id=%s and membresiadatos_id=%s", socioID, identificador);
                            abonandoSaldoSocio(cosultaValorMembresia, identificador);

                        } else if (saldoMembresia != 0) {
                            System.out.println("El usuario abonó a la membresía o no la ha pagado.");

                            String consultaValorAbonado = String.format("SELECT pago as consulta FROM pago_membresia WHERE socio_id=%s and membresiadatos_id=%s ORDER BY id DESC", socioID, identificador);
                            abonandoSaldoSocio(consultaValorAbonado, identificador);
                        }
                    } else {
                        Telegraph tele = new Telegraph("Eliminar Membresia", "Esta membresía no puede ser eliminada. Ya se cerro la caja con la cual fue pagada.", TelegraphType.NOTIFICATION_ERROR, WindowPosition.TOPRIGHT, 5000);
                        TelegraphQueue q = new TelegraphQueue();
                        q.add(tele);
                    }

                } else {
                    String consultaMembresiaPago_id = String.format("SELECT id as identificador FROM membresia_datos WHERE membresia_socio_id=%s", membresia_id);
                    ResultSet rs3 = db.sqlDatos(consultaMembresiaPago_id);
                    int identificador = 0;
                    if (rs3.next()) {
                        identificador = rs3.getInt("identificador");
                        System.out.println("identificador = " + identificador);
                    }
                    String consultaCuandoHaPagado = String.format("SELECT saldo FROM pago_membresia where membresiadatos_id =%s ORDER BY fecha_registro DESC limit 1;", identificador);
                    ResultSet rs4 = db.sqlDatos(consultaCuandoHaPagado);
                    double saldoMembresia = 0.0;
                    if (rs4.next()) {
                        // esta consulta permite saber cuanto se ha pagado por una membresía.
                        saldoMembresia = rs4.getDouble("saldo");
                        System.out.println("saldoMembresia = " + saldoMembresia);
                    }

                    if (saldoMembresia == 0.0) {
                        System.out.println("El usuario ya pagó esta membresía o es gratuita.");

                        String cosultaValorMembresia = String.format("SELECT saldo as consulta FROM pago_membresia WHERE socio_id=%s and membresiadatos_id=%s", socioID, identificador);
                        abonandoSaldoSocio(cosultaValorMembresia, identificador);

                    } else if (saldoMembresia != 0) {
                        System.out.println("El usuario abonó a la membresía o no la ha pagado.");

                        String consultaValorAbonado = String.format("SELECT pago as consulta FROM pago_membresia WHERE socio_id=%s and membresiadatos_id=%s ORDER BY id DESC", socioID, identificador);
                        abonandoSaldoSocio(consultaValorAbonado, identificador);
                    }

                }
            } catch (SQLException ex) {
                Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
            }
        } else {
            Telegraph tele = new Telegraph("Eliminar Membresia", "No ha seleccionado ninguna membresía.", TelegraphType.NOTIFICATION_ERROR, WindowPosition.TOPRIGHT, 5000);
            TelegraphQueue q = new TelegraphQueue();
            q.add(tele);
        }
    }//GEN-LAST:event_bEliminarMembresiaActionPerformed

    private void btnEditarSocioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarSocioActionPerformed
        CrearSocio crearSocio = new CrearSocio(socioID, this);
        Frame.escritorio.add(crearSocio);
        crearSocio.toFront();
        crearSocio.setVisible(true);
    }//GEN-LAST:event_btnEditarSocioActionPerformed

    private void bAgregarMembresiasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bAgregarMembresiasActionPerformed

        //try {
        //  if (ValidarMembresiasActivas()) {
        try {
            AgregarMembresia miAgregarMembresia = new AgregarMembresia(socioID, this);
            sumarEntrada(socioID, 0);
            editarCongelado("descongelar", socioID);
            miAgregarMembresia.setVisible(true);
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
        //} else {
        //  Telegraph tele = new Telegraph("Membresia existente", "El usuario ya cuenta con una membresia activa", TelegraphType.NOTIFICATION_WARNING, WindowPosition.TOPRIGHT, 4000);
        //TelegraphQueue q = new TelegraphQueue();
        //q.add(tele);

        // }
        //} catch (ParseException ex) {
        //  Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        //}
    }//GEN-LAST:event_bAgregarMembresiasActionPerformed

    private void btnRegistrarEntradaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnRegistrarEntradaActionPerformed
        try {
            RegistrarEntrada registrarEntrada = new RegistrarEntrada(arduino, socioID, this);
            arduino.openDoor();
        } catch (ParseException | SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_btnRegistrarEntradaActionPerformed

    private void bRegistrarPagoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bRegistrarPagoActionPerformed
        // TODO add your handling code here:
        RegistrarPagoMembresia pago = new RegistrarPagoMembresia(socioID, this);
        pago.setVisible(true);
        pago.setLocationRelativeTo(null);
        pago.setAlwaysOnTop(true);
    }//GEN-LAST:event_bRegistrarPagoActionPerformed

    private void rbBioimpedanciaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rbBioimpedanciaActionPerformed
        // TODO add your handling code here:
        ocultarPanel(true, false, true);
    }//GEN-LAST:event_rbBioimpedanciaActionPerformed

    private void rbMedidasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rbMedidasActionPerformed
        // TODO add your handling code here:
        ocultarPanel(false, true, true);
    }//GEN-LAST:event_rbMedidasActionPerformed

    private void txtPesoMedidasKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPesoMedidasKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPesoMedidas.getText(), txtPesoMedidas);
    }//GEN-LAST:event_txtPesoMedidasKeyReleased

    private void txtAlturaMedidasKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtAlturaMedidasKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtAlturaMedidas.getText(), txtAlturaMedidas);
    }//GEN-LAST:event_txtAlturaMedidasKeyReleased

    private void txtDensidadOseaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtDensidadOseaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtDensidadOsea.getText(), txtDensidadOsea);
    }//GEN-LAST:event_txtDensidadOseaKeyReleased

    private void txtMasaMuscularKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtMasaMuscularKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtMasaMuscular.getText(), txtMasaMuscular);
    }//GEN-LAST:event_txtMasaMuscularKeyReleased

    private void txtGrasaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtGrasaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtGrasa.getText(), txtGrasa);
    }//GEN-LAST:event_txtGrasaKeyReleased

    private void txtCuelloKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCuelloKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtCuello.getText(), txtCuello);
    }//GEN-LAST:event_txtCuelloKeyReleased

    private void txtPechoNormalKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPechoNormalKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPechoNormal.getText(), txtPechoNormal);
    }//GEN-LAST:event_txtPechoNormalKeyReleased

    private void txtPechoExtendidoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPechoExtendidoKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPechoExtendido.getText(), txtPechoExtendido);
    }//GEN-LAST:event_txtPechoExtendidoKeyReleased

    private void txtBrazoDerechoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtBrazoDerechoKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtBrazoDerecho.getText(), txtBrazoDerecho);
    }//GEN-LAST:event_txtBrazoDerechoKeyReleased

    private void txtBrazoIzquierdoKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtBrazoIzquierdoKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtBrazoIzquierdo.getText(), txtBrazoIzquierdo);
    }//GEN-LAST:event_txtBrazoIzquierdoKeyReleased

    private void txtCinturaNormalKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCinturaNormalKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtCinturaNormal.getText(), txtCinturaNormal);
    }//GEN-LAST:event_txtCinturaNormalKeyReleased

    private void txtCinturaSumidaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtCinturaSumidaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtCinturaSumida.getText(), txtCinturaSumida);
    }//GEN-LAST:event_txtCinturaSumidaKeyReleased

    private void txtPantorrillaDerechaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPantorrillaDerechaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPantorrillaDerecha.getText(), txtPantorrillaDerecha);
    }//GEN-LAST:event_txtPantorrillaDerechaKeyReleased

    private void txtPantorrillaIzquierdaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPantorrillaIzquierdaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPantorrillaIzquierda.getText(), txtPantorrillaIzquierda);
    }//GEN-LAST:event_txtPantorrillaIzquierdaKeyReleased

    private void txtPiernaDerechaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPiernaDerechaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPiernaDerecha.getText(), txtPiernaDerecha);
    }//GEN-LAST:event_txtPiernaDerechaKeyReleased

    private void txtPiernaIzquierdaKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_txtPiernaIzquierdaKeyReleased
        // TODO add your handling code here:
        utilidades.validarCampoNumericosMedidas(txtPiernaIzquierda.getText(), txtPiernaIzquierda);
    }//GEN-LAST:event_txtPiernaIzquierdaKeyReleased

    private void btnAgregarMedidasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarMedidasActionPerformed
        // TODO add your handling code here:
        if (txtAlturaMedidas.getText().isEmpty() || txtPesoMedidas.getText().isEmpty() || cboTipoActividad.getSelectedItem().equals("")) {
            JOptionPane.showMessageDialog(this, "Por favor asegurese de diligenciar los siguientes datos: \n \t ■ \tPeso \n \t ■ \tEstatura \n \t ■ \tTipo Actividad", "Control de Medidas", JOptionPane.ERROR_MESSAGE);
        } else {

            guardarMedidas();
        }
    }//GEN-LAST:event_btnAgregarMedidasActionPerformed

    private void btnConsultarMedidasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnConsultarMedidasActionPerformed
        // TODO add your handling code here:
        ControlMedidas medidas = new ControlMedidas(socioID, nombreSocio);
        medidas.setVisible(true);
    }//GEN-LAST:event_btnConsultarMedidasActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JCheckBox JcongelarMembresia;
    private javax.swing.JButton bAgregarMembresias;
    private javax.swing.JButton bEliminarMembresia;
    private javax.swing.JButton bRegistrarPago;
    private javax.swing.JButton bRegistrarVisita;
    private javax.swing.JButton btnAgregarMedidas;
    private javax.swing.JButton btnConsultarMedidas;
    private javax.swing.JButton btnEditarSocio;
    private javax.swing.JButton btnRegistrarEntrada;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox<String> cboTipoActividad;
    private com.toedter.calendar.JDateChooser dateMedidas;
    private javax.swing.JButton jButton2;
    private javax.swing.JButton jButton3;
    private javax.swing.JButton jButton4;
    private javax.swing.JButton jButton5;
    private javax.swing.JButton jButton6;
    private javax.swing.JButton jButton7;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel10;
    private javax.swing.JLabel jLabel11;
    private javax.swing.JLabel jLabel12;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel14;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JLabel jLabel17;
    private javax.swing.JLabel jLabel18;
    private javax.swing.JLabel jLabel19;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel20;
    private javax.swing.JLabel jLabel21;
    private javax.swing.JLabel jLabel22;
    private javax.swing.JLabel jLabel23;
    private javax.swing.JLabel jLabel24;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel26;
    private javax.swing.JLabel jLabel27;
    private javax.swing.JLabel jLabel28;
    private javax.swing.JLabel jLabel29;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel30;
    private javax.swing.JLabel jLabel31;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JLabel jLabel35;
    private javax.swing.JLabel jLabel36;
    private javax.swing.JLabel jLabel37;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel7;
    private javax.swing.JLabel jLabel8;
    private javax.swing.JLabel jLabel9;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel10;
    private javax.swing.JPanel jPanel11;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel14;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel16;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JPanel jPanel8;
    private javax.swing.JPanel jPanel9;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JScrollPane jScrollPane4;
    private javax.swing.JScrollPane jScrollPane5;
    private javax.swing.JScrollPane jScrollPane6;
    private javax.swing.JScrollPane jScrollPane7;
    private javax.swing.JTabbedPane jTabbedPane2;
    private javax.swing.JTable jTable4;
    private javax.swing.JTable jTable5;
    private javax.swing.JTable jTable6;
    private javax.swing.JTable jtFactura;
    private javax.swing.JLabel lCodigo;
    private javax.swing.JLabel lEdad;
    private javax.swing.JLabel lEstadoCuentaDescripcion;
    private javax.swing.JLabel lNombreUsuario;
    private javax.swing.JLabel lbComfenalco;
    private javax.swing.JLabel lblFoto;
    private javax.swing.JLabel lblSexoMedidas;
    private javax.swing.JLabel lmsjVencimiento;
    private javax.swing.JLabel lmsjVencimiento1;
    private javax.swing.JTabbedPane pane;
    private javax.swing.JPanel panelBasico;
    private javax.swing.JPanel panelBioimpedancia;
    private javax.swing.JPanel panelMedidas;
    private javax.swing.JRadioButton rbBioimpedancia;
    private javax.swing.JRadioButton rbMedidas;
    private javax.swing.JTable tablaMembresias;
    private javax.swing.JTable tablaUltimasEntradas;
    private javax.swing.JTable tablaUltimosPagos;
    private javax.swing.JTextField txtAlturaMedidas;
    private javax.swing.JTextField txtBrazoDerecho;
    private javax.swing.JTextField txtBrazoIzquierdo;
    private javax.swing.JTextField txtBuscar;
    private javax.swing.JTextField txtCinturaNormal;
    private javax.swing.JTextField txtCinturaSumida;
    private javax.swing.JTextField txtCuello;
    private javax.swing.JTextField txtDensidadOsea;
    private javax.swing.JTextField txtGrasa;
    private javax.swing.JTextField txtMasaMuscular;
    private javax.swing.JTextField txtPantorrillaDerecha;
    private javax.swing.JTextField txtPantorrillaIzquierda;
    private javax.swing.JTextField txtPechoExtendido;
    private javax.swing.JTextField txtPechoNormal;
    private javax.swing.JTextField txtPesoMedidas;
    private javax.swing.JTextField txtPiernaDerecha;
    private javax.swing.JTextField txtPiernaIzquierda;
    // End of variables declaration//GEN-END:variables

    public int membresia_id() throws SQLException {
        int membresia_id = 0;
        CachedRowSet data;
        DB db = new DB();
        String Sql = String.format("SELECT mu.membresia_id FROM membresia_usuario mu where mu.socio_id=%s", socioID);
        data = db.sqlDatos(Sql);
        while (data.next()) {
            try {
                membresia_id = data.getInt("membresia_id");
            } catch (SQLException ex) {
                Logger.getLogger(RegistrarEntrada.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        return membresia_id;
    }

    public int traerIdMembresiaAdquirida(String fechaFin) throws SQLException {
        CachedRowSet data;
        int id = 0;
        String consulta = String.format("SELECT membresia_usuario.id"
                + "                      FROM membresia_usuario, membresia_datos "
                + "                      WHERE socio_id=%s and membresia_usuario.id=%s and membresia_usuario.id = membresia_datos.membresia_socio_id and membresia_datos.fecha_fin_membresia='%s' ; ", socioID, seleccion, fechaFin);
        data = new DB().sqlDatos(consulta);
        while (data.next()) {
            try {
                id = data.getInt("id");
            } catch (SQLException ex) {
                Logger.getLogger(RegistrarEntrada.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        return id;
    }

    public void updateDatos() {
        getSocio();
        getUltimosPagos();
        getMembresiasActivas();
        getUltimasVisitas(tablaUltimasEntradas, 5);
        getVencimientoMembresias();
        getEstadoCuenta();
        obtenerFacturas(socioID);
        congeladosocio();

    }

    public void recorrer(ArrayList<String> aux) {
        for (int i = 0; i < aux.size(); i++) {
            System.out.println(aux.get(i));

        }
    }

    public ArrayList<String> obtenerFechaFinMembresias() {
        ArrayList<String> array = new ArrayList<>();
        CachedRowSet data;

        String querySQL = String.format("SELECT mendatos.fecha_fin_membresia as \"Termina\" FROM membresia mem , membresia_usuario memusu , socio s , membresia_datos mendatos\n"
                + "WHERE  mem.id = memusu.membresia_id AND s.id = memusu.socio_id AND memusu.id = mendatos.membresia_socio_id AND memusu.activa=TRUE  AND memusu.socio_id = " + socioID + "ORDER BY mendatos.fecha_fin_membresia DESC ");
        data = db.sqlDatos(querySQL);
        try {
            while (data.next()) {

                array.add(data.getDate("Termina").toString());

            }
        } catch (SQLException ex) {
            Logger.getLogger(login.class.getName()).log(Level.SEVERE, null, ex);
        }
        return array;
    }

    public ArrayList<Integer> obtenerIdMembresias() {
        ArrayList<Integer> array = new ArrayList<>();
        CachedRowSet data;

        String querySQL = String.format("SELECT mendatos.id as \"Id\" FROM membresia mem , membresia_usuario memusu , socio s , membresia_datos mendatos\n"
                + "WHERE  mem.id = memusu.membresia_id AND s.id = memusu.socio_id AND memusu.id = mendatos.membresia_socio_id AND memusu.activa=TRUE  AND memusu.socio_id = " + socioID + "ORDER BY mendatos.fecha_fin_membresia DESC ");
        data = db.sqlDatos(querySQL);
        try {
            while (data.next()) {

                array.add(data.getInt("Id"));

            }
        } catch (SQLException ex) {
            Logger.getLogger(login.class.getName()).log(Level.SEVERE, null, ex);
        }
        return array;
    }

    private void getSocio() {
        try {
            CachedRowSet data;
            data = db.sqlDatos("SELECT foto,REPLACE(concat(soc.primer_nombre,' ',soc.segundo_nombre,' ',soc.primer_apellido,' ',soc.segundo_apellido),'  ',' ') as Usuario, soc.comfenalco,EXTRACT(year FROM AGE(NOW(),soc.fecha_nacimiento))::text || ' Años' edad , soc.sexo ,soc.clave FROM socio soc WHERE soc.id = " + socioID);

            while (data.next()) {
                if (data.getBytes("foto") != null) {
                    ImageIcon foto = new ImageIcon(data.getBytes("foto"));
                    lblFoto.setIcon(foto);
                }
                switch (data.getString("sexo")) {
                    case "Masculino":

                        lblFoto.setBorder(null);
                        break;
                    case "Femenino":
                        lblFoto.setBorder(null);
                        break;
                }
                switch (data.getString("comfenalco")) {
                    case "A":
                        lbComfenalco.setText("CATEGORIA A");
                        break;
                    case "B":
                        lbComfenalco.setText("CATEGORIA B");
                        break;
                    case "N":
                        lbComfenalco.setText("NO TIENE CATEGORIA");
                        break;
                }

                lNombreUsuario.setText(data.getString("usuario"));
                nombreSocio = data.getString("usuario");
                lblSexoMedidas.setText(data.getString("sexo"));
                lCodigo.setText("Código: " + data.getString("clave"));
                lEdad.setText(data.getString("edad"));

            }
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void getUltimosPagos() {
        CachedRowSet data;
        try {

            DefaultTableModel dtmEjemplo = new DefaultTableModel(null, new String[]{"Cod. Pago", "Fecha Pago", "Hora Pago", "Valor Pagado", "Valor Restante", "Tipo Pago", "Membresia", "Quien recibe"});
            //SELECT m.id, pago.id as \"Codigo Pago\", pago.fecha_pago::date as \"Fecha Pago\" , to_char(pago.fecha_pago, 'HH12:MI:SS AM') as \"Hora Pago\"  , pago.pago as \"Valor Pagado\" , pago.saldo as \"Valor Restante\", pago.usuario_sistema_id as \"Quien Recibe\" FROM pago_membresia pago, membresia m WHERE pago.socio_id = " + socioID + " AND pago.pago <> 0 ORDER BY id DESC LIMIT 5
            data = db.sqlDatos("SELECT pago.id as \"Cod. Pago\" , pago.fecha_pago::date as \"Fecha Pago\" , to_char(pago.fecha_pago, 'HH12:MI:SS AM') as \"Hora Pago\" ,translate(to_char(pago.pago, '$9,999,999'),' ','') as \"Valor Pagado\" , translate(to_char(pago.saldo, '$9,999,999'),' ','') as \"Valor Restante\" , CASE WHEN pago.saldo = 0 THEN 'Pagada' WHEN pago.saldo > 0 THEN 'Abono'::text END AS \"Tipo Pago\" ,  CONCAT(mem.nombre,'(',memdatos.fecha_inicio_membresia,'/',memdatos.fecha_fin_membresia,')') as \"Membresia\" , CONCAT(usuariosis.primer_nombre , ' ' , usuariosis.segundo_nombre) AS \"Quien recibe\"\n"
                    + "FROM  pago_membresia pago , membresia_datos memdatos , usuario_sistema usuariosis , membresia_usuario memusuario , membresia mem\n"
                    + "WHERE pago.membresiadatos_id = memdatos.id AND  pago.usuario_sistema_id = usuariosis.id AND memdatos.membresia_socio_id = memusuario.id AND memusuario.membresia_id = mem.id AND \n"
                    + "pago.socio_id = " + socioID + " AND pago.factura_id IS NOT NULL ORDER BY pago.id DESC LIMIT 5");

            tablaUltimosPagos = logica.Utilidades.llenarTabla(data.createCopy(), dtmEjemplo, tablaUltimosPagos);
            tablaUltimosPagos.getColumnModel().getColumn(0).setMinWidth(0);
            tablaUltimosPagos.getTableHeader().getColumnModel().getColumn(0).setMaxWidth(0);

        } catch (Exception ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public boolean ValidarMembresiasActivas() throws ParseException {
        Calendar c1 = Calendar.getInstance();
        String dia = Integer.toString(c1.get(Calendar.DATE));
        String mes = Integer.toString(c1.get(Calendar.MONTH) + 1);
        String anio = Integer.toString(c1.get(Calendar.YEAR));

        String fecha_actual = anio + "-0" + mes + "-" + dia;
        int fila = tablaMembresias.getRowCount();

        if (tablaMembresias.getRowCount() == 0) {
            return true;
        } else {

            for (int i = 0; i < fila; i++) {
                Object fecha = tablaMembresias.getValueAt(i, 2);
                SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
                Date date1 = sdf.parse(fecha_actual);
                Date date2 = sdf.parse(String.valueOf(fecha));

                int v = date1.compareTo(date2);
                if (v == 1) {
                    return true;

                } else {
                    return false;
                }

            }
        }

        return false;
    }

    private void getMembresiasActivas() {
        CachedRowSet data;
        try {

            dtmEjemplo = new DefaultTableModel(null, new String[]{"Cod.", "Membresia", "Comienza", "Termina", "Estado"});
            data = db.sqlDatos("SELECT  mendatos.id ,mem.nombre as \"Membresia\" , mendatos.fecha_inicio_membresia as \"Comienza\" , mendatos.fecha_fin_membresia as \"Termina\", mendatos.estado as \"Estado\", CASE WHEN mendatos.renovar = true Then 'Si' WHEN mendatos.renovar = false Then 'No' END AS \"Renueva\" FROM membresia mem , membresia_usuario memusu , socio s , membresia_datos mendatos\n"
                    + "WHERE  mem.id = memusu.membresia_id AND s.id = memusu.socio_id AND memusu.id = mendatos.membresia_socio_id AND memusu.socio_id = " + socioID + "ORDER BY mendatos.fecha_fin_membresia DESC ");

            tablaMembresias = logica.Utilidades.llenarTabla(data.createCopy(), dtmEjemplo, tablaMembresias);
            tablaMembresias.getColumnModel().getColumn(0).setMinWidth(0);
            tablaMembresias.getTableHeader().getColumnModel().getColumn(0).setMaxWidth(0);

        } catch (Exception ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void getEstadoCuenta() {
        double saldoPendiente = 0;
        String msjEstado = "";
        try {
            saldoPendiente = utilidades.obtenerSaldoUsuario(socioID);
            if (saldoPendiente == 0) {
                bRegistrarPago.setVisible(false);
                usuarioDebe = false;
                lEstadoCuentaDescripcion.setForeground(new java.awt.Color(0, 102, 0));
                msjEstado = "Usuario esta a Paz y Salvo";
            } else {
                bRegistrarPago.setVisible(true);
                usuarioDebe = true;
                lEstadoCuentaDescripcion.setForeground(new java.awt.Color(255, 0, 0));
                msjEstado = String.format("Debe %s Pesos", saldoPendiente);

            }

            lEstadoCuentaDescripcion.setText(msjEstado);

        } catch (Exception ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void getUltimasVisitas(JTable nombreTabla, int limit) {
        CachedRowSet data;
        try {

            DefaultTableModel dtmEjemplo = new DefaultTableModel(null, new String[]{"Codigo", "Fecha", "Hora", "Membresia"});
            data = db.sqlDatos("SELECT  entrada.id, entrada.fecha_hora::date as \"Fecha\" , to_char(entrada.fecha_hora, 'HH12:MI:SS AM') as \"Hora\", mem.nombre , REPLACE(concat(s.primer_nombre,' ',s.segundo_nombre,' ',s.primer_apellido,' ',s.segundo_apellido),'  ',' ') as Usuario FROM entrada_socio entrada , socio s , membresia mem\n"
                    + "WHERE entrada.socio_id = s.id AND entrada.membresia_id = mem.id AND socio_id = " + socioID + " \n"
                    + "UNION\n"
                    + "SELECT visita.id,visita.fecha_registro::date as \"Fecha\" , to_char(visita.fecha_registro, 'HH12:MI:SS AM') as \"Hora\" , 'VISITA' , visita.nombres||' '||visita.apellidos FROM pago_visita visita WHERE visita.socio_id = " + socioID + " \n"
                    + "ORDER BY \"Fecha\" DESC LIMIT " + limit);

            nombreTabla = logica.Utilidades.llenarTabla(data.createCopy(), dtmEjemplo, nombreTabla);
            System.out.println(nombreTabla);
            System.out.println(data.createCopy());
            tablaUltimasEntradas.getColumnModel().getColumn(0).setMinWidth(0);
            tablaUltimasEntradas.getTableHeader().getColumnModel().getColumn(0).setMaxWidth(0);
        } catch (SQLException ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void getVencimientoMembresias() {
        try {
            int dias = 0;
            Date fechaVencimiento = new Date();
            CachedRowSet data;
            String sql = "SELECT mendatos.fecha_fin_membresia - now()::date as dias  , mendatos.fecha_fin_membresia as fecha_vencimiento FROM membresia mem , membresia_usuario memusu , socio s , membresia_datos mendatos\n"
                    + "WHERE  mem.id = memusu.membresia_id AND s.id = memusu.socio_id AND memusu.id = mendatos.membresia_socio_id AND mendatos.estado = 'Pagada' AND memusu.socio_id = " + socioID + " ORDER BY memusu.id DESC LIMIT 1";

            data = db.sqlDatos(sql);

            if (data.size() == 0) {
                lmsjVencimiento.setText("Socio no reporta Membresias Activas");
                //btnRegistrarEntrada.setVisible(false);
                bAgregarMembresias.setEnabled(true);
                return;
            }

            btnRegistrarEntrada.setEnabled(true);
            //bAgregarMembresias.setEnabled(false);

            //****
            while (data.next()) {
                dias = data.getInt("dias");
                fechaVencimiento = data.getDate("fecha_vencimiento");
            }

            String msj = " ";
            String fecha = Utilidades.castFecha(fechaVencimiento, "dd/MM/yyyy");

            if (dias == 0) {
                msj = "La membresia del Usuario Vence Hoy";
                utilidades.resaltarTexto(lmsjVencimiento, "naranja");
            } else if (dias < 0) {
                dias = dias * -1;
                msj = String.format("Membresia Vencida hace %s días (%s)", dias, fecha);
                utilidades.resaltarTexto(lmsjVencimiento, "rojo");
            } else {
                msj = String.format("Membresía Vence en: %s (%s Días)", fecha, dias);
                utilidades.resaltarTexto(lmsjVencimiento, "verde");
            }
            lmsjVencimiento.setText(msj);
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
    }


    /*Carga la tabla de facturas*/
    public void obtenerFacturas(int SocioId) {
        CachedRowSet data;
        String querySql;
        try {
            dtmEjemplo = new DefaultTableModel(null, new String[]{"Codigo", "Fecha", "Descripcion", "Valor"});
            querySql = String.format("SELECT fac.id, fac.fecha_registro::DATE,CONCAT(CASE WHEN pm.saldo = 0 THEN 'Pago' WHEN pm.saldo > 0 THEN 'Abono'::text END ||' Membresia '||m.nombre||' '||pm.pago||' ( '||md.fecha_inicio_membresia||'/'||md.fecha_fin_membresia||' )'),fac.paga\n"
                    + "FROM pago_membresia pm , factura fac, socio s, membresia m,membresia_datos md,membresia_usuario mu\n"
                    + "WHERE s.id = %s\n"
                    + "AND s.id = pm.socio_id\n"
                    + "AND md.id = pm.membresiadatos_id\n"
                    + "AND fac.id = pm.factura_id\n"
                    + "AND s.id = fac.socio_id\n"
                    + "AND m.id = mu.membresia_id\n"
                    + "AND s.id = mu.socio_id\n"
                    + "AND md.id = pm.membresiadatos_id\n"
                    + "AND md.membresia_socio_id = mu.id;", SocioId);

            data = db.sqlDatos(querySql);
            jtFactura = logica.Utilidades.llenarTabla(data.createCopy(), dtmEjemplo, jtFactura);
            jtFactura.getColumnModel().getColumn(0).setMinWidth(0);
            jtFactura.getTableHeader().getColumnModel().getColumn(0).setMaxWidth(0);
        } catch (Exception ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    public String obtenerFechaFinMembresia(JTable tabla) {
        int fila = tabla.getSelectedRow();
        String fechaFin = null;
        if (fila >= 0) {
            fechaFin = String.valueOf(tabla.getModel().getValueAt(fila, 3));

        }
        return fechaFin;
    }

    public boolean abonandoSaldoSocio(String consulta, int identificador) {
        try {
            double saldoMembresia = 0.0;
            ResultSet rs5 = db.sqlDatos(consulta);

            if (rs5.next()) {
                saldoMembresia = rs5.getDouble("consulta");

            }

            //Obtener el saldo anterior a favor que tiene el socio antes de la devolucion
            Double nuevoSaldoFavor = saldoMembresia;

            //consultamos cual es la caja actual
            cajaActual = utilidades.cajaActual();

            System.out.println("Abono a saldo a favor Exitoso");
//                            si se abonó exitosamente el saldo a favor pasamos a eliminar la membresía.
            String consultaEliminar1 = String.format("DELETE FROM pago_membresia WHERE membresiadatos_id=%s", identificador);
            db.sqlEjec(consultaEliminar1);

            String consultaEliminar2 = String.format("DELETE FROM membresia_datos WHERE id=%s", identificador);
            db.sqlEjec(consultaEliminar2);

            String consultaEliminar4 = String.format("DELETE FROM factura WHERE socio_id=%s and id_membresia_usuario=%s", socioID, seleccion);
            db.sqlEjec(consultaEliminar4);

            String consultaEliminar3 = String.format("DELETE FROM membresia_usuario WHERE socio_id=%s and id=%s and activa=TRUE", socioID, seleccion);
            db.sqlEjec(consultaEliminar3);
            updateDatos();

            if (saldoMembresia == 0.0) {
                Telegraph tele = new Telegraph("Eliminar Membresia", "Se ha eliminado la membresía exitosamente.", TelegraphType.NOTIFICATION_DONE, WindowPosition.TOPRIGHT, 5000);
                TelegraphQueue q = new TelegraphQueue();
                q.add(tele);
                return true;
            } else {
                Telegraph tele = new Telegraph("Eliminar Membresia", "La membresía ha sido eliminada. Debe retornar al usuario la cantidad " + "<b>" + nuevoSaldoFavor + "</b>" + " de saldo a favor.", TelegraphType.NOTIFICATION_DONE, WindowPosition.TOPRIGHT, 5000);
                TelegraphQueue q = new TelegraphQueue();
                q.add(tele);
                return true;
            }

        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
        }
        return false;
    }

    private void initRegistrarVisita() {
        if (!sinMembresias()) {
            bRegistrarVisita.setEnabled(true);
        } else {
            bRegistrarVisita.setEnabled(false);
        }
    }

    private String[] getDatosSocio() throws SQLException {
        String[] socio = new String[6];
        CachedRowSet data;
        data = db.sqlDatos("SELECT primer_nombre, segundo_nombre, primer_apellido, segundo_apellido,id,clave FROM SOCIO WHERE id=" + socioID + ";");

        while (data.next()) {
            socio[0] = data.getString("primer_nombre");
            socio[1] = data.getString("segundo_nombre");
            socio[2] = data.getString("primer_apellido");
            socio[3] = data.getString("segundo_apellido");
            socio[4] = data.getString("id");
            socio[5] = data.getString("clave");
        }
        return socio;
    }

    private boolean sinMembresias() {
        int id = 0;
        try {
            CachedRowSet data;
            String sql = String.format("SELECT count(mu.membresia_id) as cantidad FROM membresia_datos md, membresia_usuario mu where now() between md.fecha_inicio_membresia and md.fecha_fin_membresia and md.membresia_socio_id= mu.id  and mu.socio_id=%s", this.socioID);
            data = db.sqlDatos(sql);
            while (data.next()) {
                id = data.getInt("cantidad");
            }
            if (id >= 1) {
                return true;
            } else {
                return false;
            }
        } catch (SQLException ex) {
            Logger.getLogger(VerSocio.class.getName()).log(Level.SEVERE, null, ex);
            return false;
        }
    }

    public void modificarFechaFinMembresia(ArrayList<String> fechas, ArrayList<Integer> ids) {
        String querySQL = "";
        for (int i = 0; i < fechas.size(); i++) {

            boolean suceses;
            querySQL = String.format("UPDATE membresia_datos SET fecha_fin_membresia='%s' WHERE id=%s", fechas.get(i), ids.get(i));
            suceses = db.sqlEjec(querySQL);

            if (suceses) {

            }
        }

    }

    public ArrayList<String> sumardias(int dias, ArrayList<String> fechas) throws ParseException {
        for (int i = 0; i < fechas.size(); i++) {

            fechas.set(i, sumarDiasFecha(dias, fechas.get(i)));

        }

        return fechas;
    }

    public void sumarEntrada(int clave, int entada) throws SQLException {

        String querySQL = "";

        boolean suceses;
        querySQL = String.format("UPDATE socio SET entradas_hoy=%s WHERE id=%s", entada, clave);
        suceses = db.sqlEjec(querySQL);

        if (suceses) {

            return;

        }

    }

    public boolean ValidarPago() {
        if (admonMembresias.obtenerEstadoPagoMembresia(tablaMembresias).equals("Sin Cancelar")) {
            return true;
        } else {
            return false;
        }

    }

    public int diasPorMes(int nombreMes, int anio) {
        int numDias = 0;
        if (nombreMes == 4 || nombreMes == 6 || nombreMes == 9 || nombreMes == 11) {
            numDias = 30;
        } else if (nombreMes == 2) {

            // para cuando el año es bisiesto
            if ((anio % 4 == 0) && ((anio % 100 != 0) || (anio % 400 == 0))) {//si el año es bisiesto es divisible entre 4 y 100 o 400
                numDias = 29;
            } else {
                numDias = 28;//queda pendiente para año bisiesto 
            }
        } else //todos los demas meses 
        {
            numDias = 31;
        }

        return numDias;

    }

    public String sumarDiasFecha(int numeroDiasSumar, String fecha) {
        System.out.println("esta es la fecha de la base " + fecha);
        int diaActual, mesActual, anioActual;// se supone que estas variables ya contienen valores, supongamos que la fecha es:
        diaActual = Integer.parseInt(fecha.substring(8, 10));
        System.out.println("Este es el dia actual " + diaActual);
        mesActual = Integer.parseInt(fecha.substring(5, 7));
        System.out.println(mesActual);
        anioActual = Integer.parseInt(fecha.substring(0, 4));
        System.out.println(anioActual);
        System.out.println("la fecha queda" + diaActual + " de " + mesActual + "  del " + anioActual);

        int numDias = diasPorMes(mesActual, anioActual);
        System.out.println(numDias);
        if ((diaActual + numeroDiasSumar) > numDias) {

            numDias = (diaActual + numeroDiasSumar) - numDias;
            System.out.println(numDias);
            if (mesActual == 12) {
                mesActual = 1;
                anioActual++;
            } else {
                diaActual = numDias;
                mesActual++;
            }

            System.out.println("al sumar " + numeroDiasSumar + " dias la fecha queda" + diaActual + " de " + mesActual + "  del " + anioActual);

        } else {
            diaActual = diaActual + numeroDiasSumar;
            System.out.println("al sumar " + numeroDiasSumar + " dias la fecha queda" + diaActual + " de " + mesActual + "  del " + anioActual);

        }
        return anioActual + "-" + mesActual + "-" + diaActual;
    }

    public String congelado() throws SQLException {
        String aux = "";
        CachedRowSet data;
        data = db.sqlDatos("SELECT congelado FROM socio WHERE socio.id = " + socioID);

        while (data.next()) {
            aux = data.getString("congelado");

        }
        if (aux == null) {
            return "no";
        }
        return aux;
    }

    public void editarFechaCongelacion(int clave, int dias) {

        Calendar c1 = Calendar.getInstance();

        String dia = Integer.toString(c1.get(Calendar.DATE));
        String mes = Integer.toString(c1.get(Calendar.MONTH) + 1);
        String anio = Integer.toString(c1.get(Calendar.YEAR));

        if (dia.length() == 1) {
            dia = "0" + dia;
        }
        if (mes.length() == 1) {
            mes = "0" + mes;
        }
        String fecha_actual = anio + "-" + mes + "-" + dia;
        String querySQL = "";
        String aux = sumarDiasFecha(dias, fecha_actual);
        System.out.println(aux);
        boolean suceses;

        querySQL = String.format("UPDATE socio SET fecha_descongelar='%s' WHERE id=%s", aux, clave);
        suceses = db.sqlEjec(querySQL);

        if (suceses) {

        }

    }

    public void editarFechaCongelado(String fecha, int clave) {
        String querySQL = "";
        boolean suceses;

        querySQL = String.format("UPDATE socio SET fecha_descongelar='%s' WHERE id=%s", fecha, clave);
        suceses = db.sqlEjec(querySQL);

        if (suceses) {

        }
    }

    public String obtenerFechaCongelacion() throws SQLException {
        String aux = "";
        CachedRowSet data;
        data = db.sqlDatos("SELECT fecha_descongelar FROM socio WHERE socio.id = " + socioID);

        while (data.next()) {
            aux = data.getString("fecha_descongelar");

        }
        return aux;
    }

    public void editarCongelado(String congelado, int clave) {
        String querySQL = "";

        boolean suceses;

        querySQL = String.format("UPDATE socio SET congelado='%s' WHERE id=%s", congelado, clave);
        suceses = db.sqlEjec(querySQL);

        if (suceses) {

        }

    }

    public int diasRestantesCongelados() throws ParseException, SQLException {
        SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        Calendar c1 = Calendar.getInstance();

        String dia = Integer.toString(c1.get(Calendar.DATE));
        String mes = Integer.toString(c1.get(Calendar.MONTH) + 1);
        String anio = Integer.toString(c1.get(Calendar.YEAR));

        if (dia.length() == 1) {
            dia = "0" + dia;
        }
        if (mes.length() == 1) {
            mes = "0" + mes;
        }
        String fecha_actual = anio + "-" + mes + "-" + dia;
        System.out.println(obtenerFechaCongelacion());

        Date fechaInicial = dateFormat.parse(fecha_actual);
        Date fechaFinal = dateFormat.parse(obtenerFechaCongelacion());

        int dias = (int) ((fechaFinal.getTime() - fechaInicial.getTime()) / 86400000);

        System.out.println("Hay " + dias + " dias de diferencia");

        return dias;
    }

    public String restarDiasFecha(int numeroDiasRestar, String fecha) {
        System.out.println("esta es la fecha de la base " + fecha);
        int diaActual, mesActual, anioActual;// se supone que estas variables ya contienen valores, supongamos que la fecha es:
        diaActual = Integer.parseInt(fecha.substring(8, 10));
        System.out.println("Este es el dia actual " + diaActual);
        mesActual = Integer.parseInt(fecha.substring(5, 7));
        System.out.println(mesActual);
        anioActual = Integer.parseInt(fecha.substring(0, 4));
        System.out.println(anioActual);
        System.out.println("la fecha queda" + diaActual + " de " + mesActual + "  del " + anioActual);
        int aux = 0;
        int numDias = 0;
        if (mesActual == 1) {
            numDias = diasPorMes(12, anioActual);
        } else {
            numDias = diasPorMes(mesActual - 1, anioActual);
        }

        if ((diaActual - numeroDiasRestar) <= 0) {
            aux = numDias + diaActual - numeroDiasRestar;
            if (mesActual == 1) {
                mesActual = 12;
                anioActual--;
            } else {
                mesActual--;
            }

        } else {
            aux = diaActual - numeroDiasRestar;
        }

        return anioActual + "-" + mesActual + "-" + aux;
    }

    public ArrayList<String> restarDias(int dias, ArrayList<String> fechas) throws ParseException {
        for (int i = 0; i < fechas.size(); i++) {

            fechas.set(i, restarDiasFecha(dias, fechas.get(i)));

        }

        return fechas;
    }

    /**
     * *
     * Metodo que sirve para ocultar o no, los dos paneles de tomas de medidas
     */
    public void ocultarPanel(boolean bio, boolean panel, boolean basico) {
        panelBioimpedancia.setVisible(bio);
        panelMedidas.setVisible(panel);
        panelBasico.setVisible(basico);
    }

    /**
     * *
     * Metodo que sirve para cargar el tipo de actividad fisica del socio
     */
    public void cargarActividadFisica() {
        cboTipoActividad.addItem("");
        cboTipoActividad.addItem("Bajo");
        cboTipoActividad.addItem("Alto");
    }

    /**
     * *
     * Metodo que nos va a permitir guardar las medidas de los socios
     */
    public void guardarMedidas() {

        ArrayList<Double> medidas_anteriores = new ArrayList<>();

        double estatura = 0, peso = 0, densidad_osea = 0, porcentaje_masa = 0, porcentaje_grasa = 0, cuello = 0, pecho_extendido = 0, pecho_normal = 0,
                brazo_derecho = 0, brazo_izquierdo = 0, pierna_derecha = 0, pierna_izquierda = 0, pantorrilla_derecha = 0,
                pantorrilla_izquierda = 0, cintura_normal = 0, cintura_sumida = 0, estatura_anterior = 0, peso_anterior = 0, densidad_osea_anterior = 0, porcentaje_masa_anterior = 0, porcentaje_grasa_anterior = 0, cuello_anterior = 0, pecho_extendido_anterior = 0, pecho_normal_anterior = 0,
                brazo_derecho_anterior = 0, brazo_izquierdo_anterior = 0, pierna_derecha_anterior = 0, pierna_izquierda_anterior = 0, pantorrilla_derecha_anterior = 0,
                pantorrilla_izquierda_anterior = 0, cintura_normal_anterior = 0, cintura_sumida_anterior = 0;

        String tipoActividad = "", querySQL, usuario, fecha_anterior = null, actividad_fisica_anterior = "";
        boolean success = false;
        int cantidad = 0, medidas_socio_id = 0;
        usuario = System.getProperty("usuario_sistema");

        CachedRowSet dataConsulta;
        String queryConsulta = "SELECT me.id,  me.fecha_registro , actividad_fisica , peso , estatura , densidad_osea , porcentaje_muscular , porcentaje_grasa , cuello , pecho_normal , pecho_expandido , cintura_normal , cintura_sumida ,pierna_derecha , pierna_izquierda , brazo_derecho , brazo_izquierdo , pantorrilla_derecha , pantorrilla_izquierda \n"
                + "FROM medidas_socio me, socio so, usuario_sistema us\n"
                + "WHERE me.socio_id= so.id\n"
                + "AND me.usuario_sistema_id = us.id\n"
                + "AND so.id=" + socioID + "\n"
                + "AND us.id=" + usuario + "\n"
                + "ORDER BY me.id DESC\n"
                + "LIMIT 1;";

        System.out.println(queryConsulta);
        dataConsulta = db.sqlDatos(queryConsulta);
        try {
            while (dataConsulta.next()) {
                medidas_socio_id = dataConsulta.getInt("id");
                fecha_anterior = dataConsulta.getString("fecha_registro");
                actividad_fisica_anterior = dataConsulta.getString("actividad_fisica");
                peso_anterior = dataConsulta.getDouble("peso");
                estatura_anterior = dataConsulta.getDouble("estatura");
                densidad_osea_anterior = dataConsulta.getDouble("densidad_osea");
                porcentaje_masa_anterior = dataConsulta.getDouble("porcentaje_muscular");
                porcentaje_grasa_anterior = dataConsulta.getDouble("porcentaje_grasa");
                cuello_anterior = dataConsulta.getDouble("cuello");
                pecho_extendido_anterior = dataConsulta.getDouble("pecho_expandido");
                pecho_normal_anterior = dataConsulta.getDouble("pecho_normal");
                brazo_derecho_anterior = dataConsulta.getDouble("brazo_derecho");
                brazo_izquierdo_anterior = dataConsulta.getDouble("pierna_derecha");
                pierna_derecha_anterior = dataConsulta.getDouble("pierna_derecha");
                pierna_izquierda_anterior = dataConsulta.getDouble("pierna_izquierda");
                pantorrilla_derecha_anterior = dataConsulta.getDouble("pantorrilla_derecha");
                pantorrilla_izquierda_anterior = dataConsulta.getDouble("pantorrilla_izquierda");
                cintura_normal_anterior = dataConsulta.getDouble("cintura_normal");
                cintura_sumida_anterior = dataConsulta.getDouble("cintura_sumida");

            }
            medidas_anteriores.add(0.0);
            medidas_anteriores.add(peso_anterior);
            medidas_anteriores.add(estatura_anterior);
            medidas_anteriores.add(densidad_osea_anterior);
            medidas_anteriores.add(porcentaje_masa_anterior);
            medidas_anteriores.add(porcentaje_grasa_anterior);
            medidas_anteriores.add(cuello_anterior);
            medidas_anteriores.add(pecho_extendido_anterior);
            medidas_anteriores.add(pecho_normal_anterior);
            medidas_anteriores.add(brazo_derecho_anterior);
            medidas_anteriores.add(brazo_izquierdo_anterior);
            medidas_anteriores.add(pierna_derecha_anterior);
            medidas_anteriores.add(pierna_izquierda_anterior);
            medidas_anteriores.add(pantorrilla_derecha_anterior);
            medidas_anteriores.add(pantorrilla_izquierda_anterior);
            medidas_anteriores.add(cintura_normal_anterior);
            medidas_anteriores.add(cintura_sumida_anterior);

        } catch (SQLException ex) {
            Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
        }

        System.out.println("Estatura anterior: " + estatura_anterior);
        System.out.println("Peso anterior: " + peso_anterior);
        System.out.println("Este es el id de la medida del socio, el ultimo registro: " + medidas_socio_id);

        if ((cboTipoActividad.getSelectedItem() != "") && (txtAlturaMedidas.getText() != "") && (txtPesoMedidas.getText() != "")) {
            tipoActividad = cboTipoActividad.getSelectedItem().toString();
            estatura = Double.parseDouble(txtAlturaMedidas.getText());
            peso = Double.parseDouble(txtPesoMedidas.getText());
        }

        System.out.println("Esta seleccionado el bio");
        densidad_osea = (txtDensidadOsea.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtDensidadOsea.getText());
        porcentaje_masa = (txtMasaMuscular.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtMasaMuscular.getText());
        porcentaje_grasa = (txtGrasa.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtGrasa.getText());

        System.out.println("Esta seleccionado medidas");

        cuello = (txtCuello.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtCuello.getText());
        pecho_extendido = (txtPechoExtendido.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPechoExtendido.getText());
        pecho_normal = (txtPechoNormal.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPechoNormal.getText());
        brazo_derecho = (txtBrazoDerecho.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtBrazoDerecho.getText());
        brazo_izquierdo = (txtBrazoIzquierdo.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtBrazoIzquierdo.getText());
        pierna_derecha = (txtPiernaDerecha.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPiernaDerecha.getText());
        pierna_izquierda = (txtPiernaIzquierda.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPiernaIzquierda.getText());
        pantorrilla_derecha = (txtPantorrillaDerecha.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPantorrillaDerecha.getText());
        pantorrilla_izquierda = (txtPantorrillaIzquierda.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtPantorrillaIzquierda.getText());
        cintura_normal = (txtCinturaNormal.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtCinturaNormal.getText());
        cintura_sumida = (txtCinturaSumida.getText().isEmpty()) ? 0.0 : Double.parseDouble(txtCinturaSumida.getText());

        querySQL = String.format("INSERT INTO medidas_socio(usuario_sistema_id, socio_id, fecha_registro , actividad_fisica , peso, estatura, densidad_osea, porcentaje_muscular, porcentaje_grasa, cuello, pecho_normal, pecho_expandido, cintura_normal, cintura_sumida,pierna_derecha, pierna_izquierda, brazo_derecho, brazo_izquierdo, pantorrilla_derecha, pantorrilla_izquierda) VALUES (%s, %s, now(), '%s', %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)", Integer.valueOf(usuario), Integer.valueOf(socioID), tipoActividad, peso, estatura, densidad_osea, porcentaje_masa, porcentaje_grasa, cuello, pecho_normal, pecho_extendido, cintura_normal, cintura_sumida, pierna_derecha, pierna_izquierda, brazo_derecho, brazo_izquierdo, pantorrilla_derecha, pantorrilla_izquierda);
        success = db.sqlEjec(querySQL);

        if (success) {
            System.out.println("Se ha guardado con exito las medidas");

            CachedRowSet data;
            String query = "SELECT COUNT(me.id) AS CANTIDAD\n"
                    + "FROM medidas_socio me, socio so, usuario_sistema us\n"
                    + "WHERE so.id=" + socioID + "\n"
                    + "AND us.id=" + usuario + "\n"
                    + "AND me.socio_id= so.id\n"
                    + "AND me.usuario_sistema_id = us.id";

            data = db.sqlDatos(query);
            try {
                while (data.next()) {
                    cantidad = data.getInt("cantidad");
                }
            } catch (SQLException ex) {
                Logger.getLogger(RegistrarPagoMembresia.class.getName()).log(Level.SEVERE, null, ex);
            }

            System.out.println("La cantidad: " + cantidad);
            if (cantidad <= 1) {
                System.out.println("Solo exite un registro");
                JOptionPane.showMessageDialog(this, "Se ha detectado que este socio no cuenta con toma de medidas anteriores. \n Para poder hacer comparaciones se necesita una nueva toma de medidas.", "Control de Medidas", JOptionPane.INFORMATION_MESSAGE);
                limpiarCajaTexto();
            } else {
                System.out.println("El socio ya tiene mas de un registro");
                int comparar = JOptionPane.showConfirmDialog(this, "¿Desea comparar estos datos con el ultimo registro?", "Control de Medidas", JOptionPane.OK_CANCEL_OPTION);
                if (comparar == 0) {
                    System.out.println("Entramos dfgfdgdgd");
                    limpiarCajaTexto();
                    InterfazMedidas imedidas = new InterfazMedidas(fecha_anterior, medidas_anteriores, socioID, actividad_fisica_anterior);
                    imedidas.setVisible(true);

                }
            }

        }
    }

    public void limpiarCajaTexto() {

        txtDensidadOsea.setText("");
        txtMasaMuscular.setText("");
        txtGrasa.setText("");
        txtCuello.setText("");
        txtPechoExtendido.setText("");
        txtPechoNormal.setText("");
        txtBrazoDerecho.setText("");
        txtBrazoIzquierdo.setText("");
        txtPiernaDerecha.setText("");
        txtPiernaIzquierda.setText("");
        txtPantorrillaDerecha.setText("");
        txtPantorrillaIzquierda.setText("");
        txtCinturaNormal.setText("");
        txtCinturaSumida.setText("");
    }

}
